/**************************
//EJERCICIOS DE REGISTROS
Crear un procedimiento en el que insertas los datos de un empleado en la tabla empleado
EMP_NO, APELLIDO, OFICIO, salario, DEPT_NO
los parametros pasan primero por una variable registro que encaje con los parametros de entrada
y en la tabla insertamos a traves de la variable record
***************************************************/
CREATE OR REPLACE PROCEDURE INSERTANDO(EMP NUMBER, APE VARCHAR2, OFI VARCHAR2, 
sal NUMBER, DEP NUMBER)
AS
TYPE ELEMPLE IS RECORD
(
EMP_NO NUMBER(5),
APELLIDO VARCHAR2(30),
OFICIO VARCHAR2(30),
salario NUMBER(6),
DEPT_NO NUMBER(6)
);

V_EMPLE ELEMPLE;

BEGIN
V_EMPLE.EMP_NO := EMP;
V_EMPLE.APELLIDO := APE;
V_EMPLE.OFICIO := OFI;
V_EMPLE.SALARIO := SAL;
V_EMPLE.DEPT_NO := DEP; 

INSERT INTO EMPLE ("EMP_NO", "APELLIDO", "OFICIO", "SALARIO", "DEPT_NO")
VALUES(V_EMPLE.EMP_NO, V_EMPLE.APELLIDO, V_EMPLE.OFICIO, V_EMPLE.SALARIO, V_EMPLE.DEPT_NO);

END INSERTANDO;

/**********************/
/* VARRAYS            */
/**********************/

DECLARE
  TYPE T_DIAS IS VARRAY (7) OF VARCHAR2(10);
  V_SEMANA T_DIAS;
BEGIN
 V_SEMANA := T_DIAS('LUNES', 'MARTES', 'MIERCOLES','JUEVES', 'VIERNES','SABADO','DOMINGO');
 FOR i IN 1..7 LOOP
  DBMS_OUTPUT.PUT_LINE( TO_CHAR(i) || '-' || V_SEMANA(i));
 END LOOP;
END;

/* *******************************************************************/
/* CREA UN PROCEDIMIENTO CON UN CURSOR DE TODOS LOS DEPARTAMENTOS   */
--CREAMOS UN VARRAY COMPATIBLE CON EL CURSOR, COMPLETAMOS LA VARIABLE 
/*************************************************/

CREATE OR REPLACE PROCEDURE PRUEBA
AS
CURSOR C1 IS SELECT * FROM DEPART;

TYPE  R_DEPART IS RECORD 
(DEPT_NO DEPART.DEPT_NO%TYPE, 
DNOMBRE DEPART.DNOMBRE%TYPE,
LOC DEPART.LOC%TYPE);

TYPE VARRAY_DEPART IS VARRAY(5) OF R_DEPART;
VA_DEPARTAMENTOS VARRAY_DEPART := VARRAY_DEPART(NULL, NULL, NULL,NULL, NULL);
N INTEGER := 0;
BEGIN

FOR V_REG IN C1 LOOP
 N:=C1%ROWCOUNT;
 VA_DEPARTAMENTOS(N):=V_REG;
END LOOP;

FOR I IN 1..N LOOP
 DBMS_OUTPUT.PUT_LINE(VA_DEPARTAMENTOS(I));
END LOOP;

EXCEPTION 
WHEN OTHER THEN
 DBMS_OUTPUT.PUT_LINE('ERROR');
END PRUEBA;